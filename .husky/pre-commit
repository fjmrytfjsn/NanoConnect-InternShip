#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# pre-commitãƒ•ãƒƒã‚¯
# ã‚³ãƒŸãƒƒãƒˆå‰ã«Lintã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ãƒã‚§ãƒƒã‚¯

echo "ğŸ” Pre-commit ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œä¸­..."

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒã‚§ãƒƒã‚¯
echo "ğŸ“¦ Backend ã®ãƒã‚§ãƒƒã‚¯..."
cd backend

# TypeScriptå‹ãƒã‚§ãƒƒã‚¯
echo "ğŸ”§ TypeScriptå‹ãƒã‚§ãƒƒã‚¯..."
npm run type-check

# ESLint
echo "ğŸ” ESLint ãƒã‚§ãƒƒã‚¯..."
npm run lint

# Prettierãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯
echo "âœ¨ Prettierãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯..."
npm run format:check

echo "âœ… Backend ãƒã‚§ãƒƒã‚¯å®Œäº†"
cd ..

if [ -d "frontend" ]; then
  echo "ğŸ¨ Frontend ã®ãƒã‚§ãƒƒã‚¯..."
  cd frontend
  npm run type-check
  npm run lint
  npm run format:check
  echo "âœ… Frontend ãƒã‚§ãƒƒã‚¯å®Œäº†"
  cd ..
fi

echo "ğŸ‰ Pre-commit ãƒã‚§ãƒƒã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸï¼"
